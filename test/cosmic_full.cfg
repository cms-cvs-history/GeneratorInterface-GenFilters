process cosmics  = {
    
    # include services
    include "Configuration/ReleaseValidation/data/Services.cfi"
    
    # initialize  MessageLogger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    
    service = RandomNumberGeneratorService {
	untracked uint32 sourceSeed = 8913579
	PSet moduleSeeds = {
	    untracked uint32 g4SimHits = 9876
	}
    }

    # Monitor
    untracked PSet options = {
	untracked bool wantSummary = true
    }

    # Step 1 : Event Generation
    
    source = CosMuoGenSource {
	untracked int32 maxEvents = 2000 #00
	untracked double MinEn =    20. #2.
	untracked double MaxEn =   10000. # 10000
	#untracked double MinEn_CMS = 10. # default is value of MinEn
	untracked double MinTheta =  0.
	untracked double MaxTheta =  75 #88.
	untracked double MinPhi =    0.
	untracked double MaxPhi =  360.
	untracked double MinT0  =  -12.5
	untracked double MaxT0  =   12.5
	untracked double ElossScaleFactor = 1.
	untracked bool TrackerOnly = false # true: detector with tracker-only setup is used,
	#                                    so no material or B-field outside is considerd
	untracked bool MTCCHalf = false
        # Radius and +/-z of target-cylinder which cosmics HAVE to hit [mm]
	untracked double RadiusOfTarget = 8000. # default
	untracked double ZDistOfTarget = 15000. # default
    }

    #
    # Filtering before GEANT4
    #
    include "GeneratorInterface/GenFilters/data/CosmicGenFilterHelix.cfi" # defines cosmicInTracker
    # replace cosmicInTracker.monitorFile = "monitorCosmicsFilter.root"

    #
    # Filtering after SimHits produced.
    #
    module simHitsInTracker = TrackerMuFilter {
	untracked bool TrackerHits=true
	untracked bool DTMuonHits=false
	untracked bool CSCMuonHits=false
	untracked bool RPCMuonHits=false
    }
    
    #
    # Simulation (with vertex smearing disabled and timing of
    # tracker electronics adjusted).
    #
    include "Configuration/StandardSequences/data/Simulation.cff"
    # might need only this, providing sequence trDigi = { siPixelDigis & siStripDigis }:
    include "SimTracker/Configuration/data/SimTracker.cff"
    include "Configuration/StandardSequences/data/MixingNoPileUp.cff" 
    # FIXME: following line will become obsolete in some 1_4_0_preX:
    replace g4SimHits.Generator.HepMCProductLabel="source" # no Vtx smearing 
    replace siStripDigis.PeakMode = true   # what about '2nd' param APVpeakmode = false?
    replace siStripDigis.CosmicDelayShift = 30.
    # according to Danek Kotlinski nothing special needed for pixel...

    #
    # Event Reconstruction (with modified tracking for cosmics)
    #
#    include "Configuration/StandardSequences/data/Reconstruction.cff"
#    include "RecoTracker/Configuration/data/RecoTracker.cff"
    include "RecoLocalTracker/Configuration/data/RecoLocalTracker.cff"
    include "RecoTracker/Configuration/data/RecoTrackerCosmicsP5.cff"
    replace siStripClusters.ChannelThreshold    = 3.0
    replace siStripClusters.SeedThreshold       = 4.0
    replace siStripClusters.ClusterThreshold    = 5.0
    # no changes for pixel???

#    include "RecoTracker/TkSeedGenerator/data/CosmicSeed.cff"
#    include "RecoTracker/SingleTrackPattern/data/CosmicTrackFinder.cfi"

    # Event output
    include "Configuration/EventContent/data/EventContent.cff"
#    replace FEVTSIMEventContent.outputCommands += "keep *_cosmicseedfinder_*_*" # not needed
#    replace FEVTSIMEventContent.outputCommands += "keep *_cosmictrackfinder_*_*" # dito
    replace FEVTSIMEventContent.outputCommands += "keep *_*P5_*_*" # keep all from P5 modules

    module FEVT = PoolOutputModule
    { 
	using FEVTSIMEventContent
	#untracked vstring outputCommands = { "keep *" } # ensure what should be the default

	untracked string fileName = "test_cosmics.root"
    }
    
    endpath e = {cosmicInTracker, g4SimHits, simHitsInTracker,
 	mix, trDigi, trackingtruth,
	trackerlocalreco, # ckftracks, 
	ckfcosmictracksP5, 
	cosmictracksP5, # cosmicseedfinder, cosmictrackfinder,
	FEVT}
}
